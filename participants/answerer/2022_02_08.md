## 数据库相关面试题（二）
**1. 什么是Redis？**

Redis 是一种基于内存的高性能key-value数据库。

整个数据库统统加载在内存当中进行操作，定期通过异步操作把数据库数据flush到硬盘上进行保存。
因为是纯内存操作，Redis的速度快。支持丰富数据类型，如string（字符串），hash（哈希），list（列表），set（集合）及zset(sorted set：有序集合)。支持事务。
Redis的主要缺点是数据库容量受到物理内存的限制，不能用作海量数据的高性能读写，因此Redis适合的场景主要局限在较小数据量的高性能操作和运算上。

**2. Redis怎么实现高效缓存?**

为了提供网站的负载能力，需要将一个访问频路较高，且经过复杂计算或者IO资源消耗较大的操作的结果缓存起来，并设置一个失效时间。每次用户访问的时候，先检查该键是否存在，如果存在直接获取该元素并返回，如果不存在，则经过一系列计算并将结果缓存，设置失效时间，在返回给用户

**3. Redis持久化有哪几种方式，怎么选？**

Redis是一种高级key-value数据库。它跟memcached类似，不过数据可以持久化。Redis的所有数据都是保存在内存中，然后不定期的通过异步方式保存到磁盘上。redis提供两种方式进行持久化，一种是RDB持久化（原理是将Reids在内存中的数据库记录定时dump到磁盘上的RDB持久化），另外一种是AOF（append only file）持久化（原理是将Reids的操作日志以追加的方式写入文件）。

RDB是定期将数据写入磁盘，当redis出现故障时，有一部分内存数据肯定会丢失。而AOF是以日志的方式追加，数据丢失会少很多。对于同一份数据来说，AOF 日志文件通常比 RDB 数据快照文件更大，数据恢复慢一些。

不要仅仅使用 RDB，因为那样会导致你丢失很多数据

也不要仅仅使用 AOF，因为那样有两个问题，第一，你通过 AOF 做冷备，没有 RDB 做冷备，来的恢复速度更快; 第二，RDB 每次简单粗暴生成数据快照，更加健壮，可以避免 AOF 这种复杂的备份和恢复机制的 bug。

redis 支持同时开启开启两种持久化方式，我们可以综合使用 AOF 和 RDB 两种持久化机制，用 AOF 来保证数据不丢失，作为数据恢复的第一选择; 用 RDB 来做不同程度的冷备，在 AOF 文件都丢失或损坏不可用的时候，还可以使用 RDB 来进行快速的数据恢复。

**4. Redis对于过期键的清除策略？**

被动删除：当读/写一个已经过期的key时，会触发惰性删除策略，直接删除掉这个过期key
主动删除：由于惰性删除策略无法保证冷数据被及时删掉，所以Redis会定期主动淘汰一批已过期的key
当前已用内存超过maxmemory限定时，触发主动清理策略

**5. Redis单线程为什么快？**

完全基于内存，绝大部分请求是纯粹的内存操作，非常快速。
采用单线程，避免了不必要的上下文切换和竞争条件，也不存在多进程或者多线程导致的切换而消耗 CPU，不用去考虑各种锁的问题，不存在加锁释放锁操作，没有因为可能出现死锁而导致的性能消耗
使用多路I/O复用模型，非阻塞IO
**6. Redis如何实现高可用？**

主从复制数据：实现数据库的读写分离，主数据库主要进行写操作，而从数据库负责读操作。
哨兵机制：监控（哨兵（sentinel）会不断地检查你的Master和Slave是否运作正常）、提醒（当被监控的某个Redis出现问题时, 哨兵（sentinel）可以通过 API 向管理员或者其他应用程序发送通知）、自动故障迁移（当一个Master不能正常工作时，哨兵（sentinel）会开始一次自动故障迁移操作,它会将失效Master的其中一个Slave升级为新的Master）
